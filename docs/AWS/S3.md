# Amazon S3 (Simple Storage Service)

Amazon S3 is an object storage service offering industry-leading scalability, data availability, security, and performance.

## Basic S3 Operations

### List Buckets

```sh
aws s3 ls
```

### Create a Bucket

```sh
aws s3 mb s3://my-new-bucket
```

### Upload a File

```sh
aws s3 cp localfile.txt s3://my-bucket/
```

### Download a File

```sh
aws s3 cp s3://my-bucket/remotefile.txt .
```

## Syncing Files with S3

The `s3 sync` command synchronizes contents between local and S3 locations:

```sh
aws s3 sync <source> <target> [--options]
```

Options include:

| Option      | Description                                           |
| ----------- | ----------------------------------------------------- |
| `--exclude` | Exclude files matching the pattern                    |
| `--include` | Include files matching the pattern                    |
| `--dryrun`  | Simulate the sync operation                           |
| `--delete`  | Remove files in target not present in source          |
| `--quiet`   | Suppress non-error output                             |

Example:

```sh
aws s3 sync . s3://my-bucket/backup --exclude "*.tmp" --delete
```

> [!TIP]
> Use the "Copy S3 URI" button in the S3 console to easily copy bucket/object URIs.

## Working with S3 Objects

### Rename/Move Objects

While `mv` exists, it's not atomic. Use `cp` followed by `rm` for better control:

```sh
aws s3 cp s3://my-bucket/oldname s3://my-bucket/newname \
    && aws s3 rm s3://my-bucket/oldname
```

### List Objects with a Specific Prefix

```sh
aws s3 ls s3://my-bucket/prefix/
```

### Delete Multiple Objects

```sh
aws s3 rm s3://my-bucket/prefix --recursive
```

## S3 Storage Classes

S3 offers various [storage classes](https://aws.amazon.com/s3/storage-classes/) for different use cases:

- Standard
- Intelligent-Tiering
- Standard-IA (Infrequent Access)
- One Zone-IA
- Glacier Instant Retrieval
- Glacier Flexible Retrieval
- Glacier Deep Archive

### Working with Glacier Storage Class

To restore a Glacier object:

```sh
aws s3api restore-object --bucket my-bucket --key path/to/object --restore-request '{"Days":5,"GlacierJobParameters":{"Tier":"Standard"}}'
```

Check restore status:

```sh
aws s3api head-object --bucket my-bucket --key path/to/object
```

When downloading restored Glacier objects:

```sh
aws s3 cp s3://my-bucket/path/to/object . --force-glacier-transfer
```

## Mounting S3 as a Filesystem

Using [mountpoint-s3](https://github.com/awslabs/mountpoint-s3):

1. Install:

```sh
wget https://s3.amazonaws.com/mountpoint-s3-release/latest/x86_64/mount-s3.deb
sudo apt-get install ./mount-s3.deb -y && rm mount-s3.deb
```

2. Mount:

```sh
mount-s3 my-bucket /mnt/s3
```

## S3 Best Practices

1. Use appropriate storage classes for cost optimization
2. Implement versioning for critical data
3. Use S3 bucket policies and IAM for access control
4. Enable server-side encryption for sensitive data
5. Use S3 lifecycle policies to automate data management
6. Implement S3 replication for disaster recovery
7. Use S3 Transfer Acceleration for faster uploads/downloads

## Advanced S3 Features

- **S3 Select**: Retrieve subsets of data using SQL-like queries
- **S3 Batch Operations**: Perform large-scale batch operations on S3 objects
- **S3 Object Lock**: Prevent object deletion or overwrite
- **S3 Access Points**: Customize access to shared datasets

For more information, refer to the [Amazon S3 Developer Guide](https://docs.aws.amazon.com/AmazonS3/latest/dev/Welcome.html).
